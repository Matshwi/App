<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>App name - UI Login Form</title>
  <link rel="stylesheet" href="./style.css">
<style>
body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}

.requirements{
  margin-top: 20px;
  background-color: black;
  color: white;
  border-radius: 5px;
  padding: 5px;
}

.requirements1{
  margin-top: 20px;
  border-radius: 5px;
  padding: 5px;
  box-shadow:20px 20px 30px;
}
</style>
</head>
<body>
<!-- partial:index.partial.html -->
<!DOCTYPE html>
<html>
<head>
	<title>registration App</title>
	<link rel="stylesheet" type="text/css" href="jslogin.css">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta name="x-apple-disable-message-reformatting">
    <meta name="viewport" content="width=device-width, initial-scale=0.86, maximum-scale=3.0, minimum-scale=0.86">

</head>
<body onload="openmodal()">
	<div class="app">

		<div class="bg" style="background: linear-gradient(to right, #32be8f, #38d39f, #32be8f);"></div>

		<form>
			<header>
				<img src="https://42f2671d685f51e10fc6-b9fcecea3e50b3b59bdc28dead054ebc.ssl.cf5.rackcdn.com/illustrations/reading_0re1.svg">
			</header>


			<div class="inputs">
				<input type="text" id="name" placeholder="first name">
				<input type="text" id="last" placeholder="last name">
				<input type="text" id="Address" placeholder="Address">
				<input type="text" id="contact" placeholder="phone number">
				<input type="text" id="identity" placeholder="ID numer">
				<input type="text" id="email" placeholder="email">
				<input type="password" id="pass" placeholder="password">
				<input type="file" id="photo">
			</div>

		</form>
    <div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>Welcome Rider</p>
    <div class="requirements"><h3 style="margin-bottom: 10px;">Rider with a car</h3> Driver must must be 21 years old minimum, have a drivers license and insurance(if driver does not have insurance at first instance the driver will be given 6 months to get insurance) and vehicle must be in good condition</div>

    <div class="requirements1"><h3 style="margin-bottom: 10px;">Rider with a Motor Bike</h3> Driver must must be 20 years old minimum, have a license and insurance(if driver does not have insurance at first instance the driver will be given 6 months to get insurance) and vehicle must be in good condition</div>

    <div class="requirements"><h3 style="margin-bottom: 10px;">Driver without vehicle</h3> Driver must must be 21 years old minimum, have a drivers license and insurance(if driver does not have insurance at first instance the driver will be given 6 months to get insurance) and vehicle must be in good condition</div>
  </div>

</div>

		<footer>
			<button id="insert" onclick="register()" style="cursor: pointer;">Continue</button>
		</footer>


	</div>
</body>
</html>
<!-- partial -->
  

<!-- TODO: Add SDKs for Firebase products that you want to use 

 https://firebase.google.com/docs/web/setup#available-libraries -->
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <!--<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-analytics.js"></script>-->

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>

<script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-storage.js"></script>

  <script type="text/javascript">
  	
  	// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBJIFHI6-heOanbGwgOJPzDUnSprKVYibo",
  authDomain: "hackathon-22201.firebaseapp.com",
  databaseURL: "https://hackathon-22201-default-rtdb.firebaseio.com",
  projectId: "hackathon-22201",
  storageBucket: "hackathon-22201.appspot.com",
  messagingSenderId: "992681123090",
  appId: "1:992681123090:web:f0f35ff9d8bb4ee44667cb",
  measurementId: "G-2KSFQT6NHD"
};


// Initialize Firebase
firebase.initializeApp(firebaseConfig);
// Initialize variables
const auth = firebase.auth()
const database = firebase.database()




const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const theid = urlParams.get('emaid')
const thename = urlParams.get('name')




var imgurl;

var files = [];

//var name = document.getElementById("name").value;
//var desc = document.getElementById("desc").value;
//var activity = document.getElementById("activity").value;
//var skills = document.getElementById("skills").value;
//var Sponsor = document.getElementById("Sponsor").value;
//var img = name;

var reader;





//insert

// Set up our register function
function register() {
  // Get all our input fields
  name = document.getElementById('name').value
  last = document.getElementById('last').value
  Address = document.getElementById('Address').value
  contact = document.getElementById('contact').value
  identity = document.getElementById('identity').value
  email = document.getElementById('email').value
  password = document.getElementById('pass').value
var imgurl;

var files = [];
var reader;


  // Validate input fields
  if (validate_email(email) == false || validate_password(password) == false) {
    alert('Email or Password is Outta Line!!')
    return
    // Don't continue running the code
  }
  if (validate_field(Regnum) == false || validate_field(Company) == false || validate_field(Address) == false || validate_field(link) == false || validate_field(field) == false) {
    alert('One or More Extra Fields is Outta Line!!')
    return
  }

  var uploadtask = firebase.storage().ref('vendorMedia/');

  const file = document.querySelector("#photo").files[0];
      const   nameofimg = Date.now() + "-" + file.name;
      const metadata = {
        contentType: file.type
      };
      const task = uploadtask.child(nameofimg);

 task.put(file, metadata).then(data => {
                data.ref.getDownloadURL().then(url => {
                    imgurl = url;
 
  // Move on with Auth
  auth.createUserWithEmailAndPassword(email, password)
  .then(function() {
    // Declare user variable
    var user = auth.currentUser

    // Add this user to Firebase Database
    var database_ref = database.ref()

    // Create User data
    var user_data = {
      Email : email,
      First_Name: name,
      Address : Address,
      Last_name : last,
      PhoneNum: contact,
      Logo: imgurl,
      IDnumber: identity,
      last_login : Date.now()
    }

    // Push to Firebase Database
    database_ref.child('Driver/' + user.uid).set(user_data)

    // DOne
    alert('User Created!!')
    location.href = "car/index.html?userid=" + user.uid
    });

  });
  })
  .catch(function(error) {
    // Firebase will use this to alert of its errors
    var error_code = error.code
    var error_message = error.message

    alert(error_message)
  })
}










// Validate Functions
function validate_email(email) {
  expression = /^[^@]+@\w+(\.\w+)+\w$/
  if (expression.test(email) == true) {
    // Email is good
    return true
  } else {
    // Email is not good
    return false
  }
}

function validate_password(password) {
  // Firebase only accepts lengths greater than 6
  if (password < 6) {
    return false
  } else {
    return true
  }
}

function validate_field(field) {
  if (field == null) {
    return false
  }

  if (field.length <= 0) {
    return false
  } else {
    return true
  }
}

// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
function openmodal() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}


  </script>




</body>
</html>
